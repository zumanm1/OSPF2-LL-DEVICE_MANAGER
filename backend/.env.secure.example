# ============================================================================
# NetMan OSPF Device Manager - Secure Configuration Example
# ============================================================================
# IMPORTANT: Copy this file to .env.local and configure for your environment
# DO NOT commit .env.local to version control!
# ============================================================================

# ============================================================================
# AUTHENTICATION & SESSION SECURITY
# ============================================================================

# Enable authentication (set to false only for development/testing)
SECURITY_ENABLED=true

# Admin credentials (CHANGE THESE!)
APP_USERNAME=admin
APP_PASSWORD=Change_This_Strong_P@ssw0rd!

# Maximum number of logins before password expires (0 = unlimited)
APP_LOGIN_MAX_USES=10000

# Session timeout in seconds (3600 = 1 hour, 86400 = 24 hours)
APP_SESSION_TIMEOUT=3600

# Secret key for session signing (MUST BE RANDOM AND SECRET!)
# Generate with: python -c "import secrets; print(secrets.token_hex(32))"
APP_SECRET_KEY=CHANGE_THIS_TO_A_RANDOM_64_CHARACTER_HEX_STRING_GENERATED_BY_SECRETS_MODULE

# ============================================================================
# NETWORK ACCESS CONTROL
# ============================================================================

# Restrict to localhost only (recommended for single-user deployments)
LOCALHOST_ONLY=true

# Allowed hosts (comma-separated IPs/hostnames)
# Only used when LOCALHOST_ONLY=false
ALLOWED_HOSTS=127.0.0.1,localhost,172.16.39.172

# CORS origins (comma-separated URLs)
# Add your frontend URLs here
CORS_ORIGINS=http://localhost:9050,http://127.0.0.1:9050,http://172.16.39.172:9050

# ============================================================================
# RATE LIMITING
# ============================================================================

# Enable rate limiting to prevent brute force attacks
RATE_LIMIT_ENABLED=true

# Login attempts: max requests per window
RATE_LIMIT_LOGIN_MAX=5
RATE_LIMIT_LOGIN_WINDOW=300  # 5 minutes

# API calls: max requests per window
RATE_LIMIT_API_MAX=100
RATE_LIMIT_API_WINDOW=60  # 1 minute

# Automation jobs: max concurrent jobs
RATE_LIMIT_JOBS_MAX=3

# ============================================================================
# PASSWORD POLICY
# ============================================================================

# Minimum password length
PASSWORD_MIN_LENGTH=8

# Maximum password length
PASSWORD_MAX_LENGTH=128

# Require uppercase letters
PASSWORD_REQUIRE_UPPERCASE=true

# Require lowercase letters
PASSWORD_REQUIRE_LOWERCASE=true

# Require digits
PASSWORD_REQUIRE_DIGIT=true

# Require special characters
PASSWORD_REQUIRE_SPECIAL=true

# Password expiry in days (0 = never expires)
PASSWORD_EXPIRY_DAYS=90

# Force password change on first login
PASSWORD_FORCE_CHANGE_FIRST_LOGIN=true

# ============================================================================
# AUDIT LOGGING
# ============================================================================

# Enable security audit logging
AUDIT_LOG_ENABLED=true

# Audit log retention in days
AUDIT_LOG_RETENTION_DAYS=365

# Log level (DEBUG, INFO, WARNING, ERROR, CRITICAL)
LOG_LEVEL=INFO

# Log to file
LOG_TO_FILE=true

# Log to console
LOG_TO_CONSOLE=true

# ============================================================================
# DATABASE SECURITY
# ============================================================================

# Database encryption at rest (requires cryptography package)
DB_ENCRYPTION_ENABLED=true

# Database backup retention in days
DB_BACKUP_RETENTION_DAYS=30

# Auto-backup interval in hours (0 = disabled)
DB_AUTO_BACKUP_INTERVAL=24

# ============================================================================
# DEVICE CREDENTIALS ENCRYPTION
# ============================================================================

# Encrypt device passwords in database (RECOMMENDED!)
DEVICE_PASSWORD_ENCRYPTION=true

# Encryption algorithm (fernet, aes256)
ENCRYPTION_ALGORITHM=fernet

# Encryption key rotation interval in days (0 = never)
ENCRYPTION_KEY_ROTATION_DAYS=90

# ============================================================================
# API SECURITY
# ============================================================================

# Maximum request size in MB
MAX_REQUEST_SIZE_MB=10

# Request timeout in seconds
REQUEST_TIMEOUT=30

# Enable API key authentication (in addition to session auth)
API_KEY_AUTH_ENABLED=false

# API key (generate with: python -c "import secrets; print(secrets.token_urlsafe(32))")
API_KEY=

# ============================================================================
# JUMPHOST CONFIGURATION
# ============================================================================

# Enable jumphost/bastion support
JUMPHOST_ENABLED=false

# Jumphost IP address
JUMPHOST_IP=

# Jumphost SSH port
JUMPHOST_PORT=22

# Jumphost username
JUMPHOST_USERNAME=

# Jumphost password (encrypted if DEVICE_PASSWORD_ENCRYPTION=true)
JUMPHOST_PASSWORD=

# Jumphost SSH key path (alternative to password)
JUMPHOST_KEY_PATH=

# ============================================================================
# SECURITY HEADERS
# ============================================================================

# Enable strict security headers
SECURITY_HEADERS_ENABLED=true

# Enable HSTS (HTTP Strict Transport Security)
# Only enable if using HTTPS!
HSTS_ENABLED=false
HSTS_MAX_AGE=31536000  # 1 year

# Content Security Policy mode (enforce, report-only)
CSP_MODE=enforce

# ============================================================================
# BACKUP & RECOVERY
# ============================================================================

# Backup directory
BACKUP_DIR=./backups

# Backup encryption (requires encryption key)
BACKUP_ENCRYPTION=true

# Backup compression
BACKUP_COMPRESSION=true

# ============================================================================
# MONITORING & ALERTS
# ============================================================================

# Enable failed login alerts
ALERT_FAILED_LOGINS=true

# Failed login threshold before alert
ALERT_FAILED_LOGIN_THRESHOLD=3

# Alert email (requires SMTP configuration)
ALERT_EMAIL=

# SMTP server for alerts
SMTP_SERVER=
SMTP_PORT=587
SMTP_USE_TLS=true
SMTP_USERNAME=
SMTP_PASSWORD=

# ============================================================================
# DEVELOPMENT/DEBUGGING (SET TO FALSE IN PRODUCTION!)
# ============================================================================

# Debug mode (shows detailed error messages)
DEBUG_MODE=false

# Allow HTTP (disable HTTPS requirement)
ALLOW_HTTP=true

# Disable security headers (for development only)
DISABLE_SECURITY_HEADERS=false

# Skip authentication (DANGEROUS - development only!)
SKIP_AUTH=false

# ============================================================================
# ADVANCED SETTINGS
# ============================================================================

# Worker threads for async operations
WORKER_THREADS=4

# Connection pool size
CONNECTION_POOL_SIZE=10

# Query timeout in seconds
QUERY_TIMEOUT=30

# WebSocket ping interval in seconds
WS_PING_INTERVAL=30

# WebSocket timeout in seconds
WS_TIMEOUT=300

# ============================================================================
# END OF CONFIGURATION
# ============================================================================
